# Правила и конфигурации Cursor для разработки на 1С

Набор правил, агентов, навыков и команд для эффективной разработки на платформе 1С:Предприятие 8.3 с использованием Cursor IDE и MCP-серверов.

## Содержание

- [Назначение](#назначение)
- [Структура каталога](#структура-каталога)
- [Установка](#установка)
- [MCP-серверы](#mcp-серверы)
- [Агенты](#агенты)
- [Правила](#правила)
- [Навыки](#навыки)
- [Команды](#команды)
- [Сообщество](#сообщество)

## Назначение

Данный репозиторий предназначен для размещения в папке `.cursor` вашего проекта 1С. Он содержит:

- **Агенты** — специализированные AI-ассистенты для различных задач разработки
- **Правила** — стандарты кодирования, антипаттерны, best practices для 1С
- **Навыки** — углублённые знания по специфическим темам (оптимизация запросов, работа с БСП)
- **Команды** — готовые сценарии для развёртывания и тестирования

Репозиторий ориентирован на использование MCP-серверов с [vibecoding1c.ru](https://vibecoding1c.ru/).

## Структура каталога

```
.cursor/
├── agents/                    # AI-агенты для различных ролей
│   ├── analytic.md           # Бизнес-аналитик (PRD, ТЗ, спецификации)
│   ├── architect.md          # Архитектор решений
│   ├── arch-reviewer.md      # Ревьюер архитектуры
│   ├── code-reviewer.md      # Ревьюер кода
│   ├── developer.md          # Разработчик
│   ├── doc-writer.md         # Технический писатель
│   ├── error-fixer.md        # Исправление ошибок
│   ├── performance-optimizer.md  # Оптимизация производительности
│   ├── planner.md            # Планировщик задач
│   ├── refactoring.md        # Рефакторинг
│   └── tester.md             # Тестирование
│
├── rules/                     # Правила и стандарты
│   ├── project_rules.mdc     # Основные правила проекта (всегда активны)
│   ├── user_rules.mdc        # Пользовательские правила (всегда активны)
│   ├── mcp-tools.mdc         # Справочник MCP-инструментов
│   ├── sdd-integrations.mdc  # Интеграции SDD-фреймворков (Memory Bank, OpenSpec, Spec Kit, TaskMaster)
│   ├── anti-patterns.mdc     # Антипаттерны и оптимизации
│   ├── form_module_rules.mdc # Правила модулей форм
│   ├── forms_add.mdc         # Создание форм
│   ├── forms_events_add.mdc  # Обработчики событий форм
│   ├── integrations_add.mdc  # Интеграции
│   ├── refactor_add.mdc      # Рефакторинг
│   └── getconfigfiles.mdc    # Выгрузка конфигурации
│
├── skills/                    # Специализированные навыки
│   ├── 1c-bsp-command/        # Добавление команд БСП
│   ├── 1c-bsp-registration/   # Регистрация в БСП
│   ├── 1c-epf-scaffold/       # Создание внешних обработок
│   ├── 1c-form-compile/       # Компиляция Form.xml из JSON DSL
│   ├── 1c-form-edit/          # Редактирование существующих форм
│   ├── 1c-form-info/          # Анализ структуры формы
│   ├── 1c-form-patterns/      # Паттерны проектирования форм
│   ├── 1c-form-scaffold/      # Создание/удаление управляемых форм
│   ├── 1c-form-validate/      # Валидация структуры формы
│   ├── 1c-help-manage/        # Управление встроенной справкой
│   ├── 1c-mxl-compile/        # Компиляция макетов из JSON DSL
│   ├── 1c-mxl-decompile/      # Декомпиляция макетов в JSON DSL
│   ├── 1c-mxl-info/           # Анализ структуры макетов
│   ├── 1c-mxl-validate/       # Валидация макетов
│   ├── 1c-platform-ops/       # Операции с платформой 1С
│   ├── 1c-query-optimization/  # Оптимизация запросов
│   ├── 1c-role-compile/       # Создание ролей
│   ├── 1c-role-info/          # Анализ прав ролей
│   ├── 1c-ssl-patterns/       # Паттерны работы с БСП
│   ├── 1c-template-manage/    # Управление макетами объектов
│   ├── img-grid-analysis/     # Анализ изображений сеткой
│   ├── mermaid-diagrams/      # Создание Mermaid-диаграмм
│   └── powershell-windows/    # PowerShell на Windows
│
├── commands/                  # Команды для выполнения
│   ├── deploy_and_test.md    # Развёртывание и тестирование
│   └── getconfigfiles.md     # Выгрузка файлов конфигурации
│
└── README.md                  # Этот файл
```

## Установка

1. Скопируйте содержимое репозитория в папку `.cursor` вашего проекта 1С
2. Настройте MCP-серверы согласно инструкциям на [vibecoding1c.ru](https://vibecoding1c.ru/)
3. Создайте файл `infobasesettings.md` в корне проекта с настройками вашей информационной базы:
   - Путь подключения к базе (например, `C:\Users\...\InfoBase`)
   - URL публикации для тестирования (например, `http://localhost/MyBase/ru/`)

## MCP-серверы

Правила оптимизированы для работы с MCP-инструментами. Основные инструменты:

### Поиск кода и документации

| Инструмент | Назначение |
|------------|------------|
| **docsearch** | Поиск в документации платформы 1С |
| **codesearch** | Поиск в коде текущей конфигурации |
| **templatesearch** | Поиск шаблонов и примеров кода |
| **helpsearch** | Поиск информации о объектах метаданных |
| **ssl_search** | Поиск функций БСП (Стандартной Библиотеки Подсистем) |

### Работа с метаданными

| Инструмент | Назначение |
|------------|------------|
| **search_metadata** | Поиск и проверка структуры метаданных |
| **business_search** | Семантический поиск объектов по описанию |
| **answer_metadata_question** | Ответы на вопросы о работе объектов |

### Проверка качества кода

| Инструмент | Назначение |
|------------|------------|
| **syntaxcheck** | Синтаксический контроль BSL (макс. 3 раза за цикл) |
| **check_1c_code** | Анализ логики и производительности |

## Агенты

Агенты — это специализированные AI-ассистенты с предустановленными инструкциями для конкретных задач.

### Разработка

| Агент | Описание |
|-------|----------|
| **1c-developer** | Основной агент для написания кода. Следует стандартам, использует MCP-инструменты, проводит самопроверку |
| **1c-architect** | Проектирование архитектуры модификаций. Анализ паттернов, trade-off analysis, диаграммы |
| **1c-analytic** | Бизнес-анализ и документация. PRD, ТЗ, спецификации без написания кода |

### Качество кода

| Агент | Описание |
|-------|----------|
| **1c-code-reviewer** | Ревью кода с confidence scoring. Проверка на антипаттерны, безопасность, производительность |
| **1c-arch-reviewer** | Ревью архитектурных решений |
| **1c-error-fixer** | Исправление ошибок и проблем |
| **1c-refactoring** | Рефакторинг с сохранением функциональности |
| **1c-performance-optimizer** | Оптимизация производительности |

### Документация и планирование

| Агент | Описание |
|-------|----------|
| **1c-doc-writer** | Написание технической документации |
| **1c-planner** | Планирование задач и декомпозиция |
| **1c-tester** | Разработка тестов |

## Правила

### Автоматически применяемые (alwaysApply: true)

- **project_rules.mdc** — основные правила разработки на 1С:
  - Использование MCP-инструментов
  - Стандарты форматирования кода
  - Правила написания запросов
  - Работа с данными через БСП
  - Оптимизация производительности

- **user_rules.mdc** — общие принципы работы:
  - Пошаговый подход
  - Минимальные изменения
  - Проверка перед изменениями

### Контекстно применяемые

- **mcp-tools.mdc** — справочник всех MCP-инструментов с примерами использования
- **sdd-integrations.mdc** — интеграции с SDD-фреймворками (загружается по требованию, см. ниже)
- **anti-patterns.mdc** — каталог антипаттернов с примерами исправления:
  - Критические: запросы в цикле, точечная нотация, подзапросы в SELECT
  - Высокие: фильтр WHERE на виртуальных таблицах, лишние серверные вызовы
  - Средние: отсутствие кэширования, O(n²) алгоритмы, глубокая вложенность
- **form_module_rules.mdc** — правила для модулей форм (клиент-серверное взаимодействие, директивы компиляции)

## SDD-интеграции (Spec-Driven Development)

Все агенты поддерживают опциональную интеграцию с SDD-фреймворками, если они присутствуют в проекте. Подробности см. в `rules/sdd-integrations.mdc`.

### Поддерживаемые фреймворки

| Фреймворк | Тип | Описание | Обнаружение |
|-----------|-----|----------|-------------|
| **cursor-memory-bank** | Файловый | Управление контекстом через `memory-bank/` | Папка `memory-bank/` |
| **OpenSpec** | Файловый | Спецификации и предложения изменений | Папка `openspec/specs/` |
| **spec-kit** (GitHub) | Файловый | Управление архитектурными ограничениями | Файлы `spec.md`, `constitution.md` |
| **TaskMaster** | MCP-сервер | AI-управление задачами | MCP `user-task-master-ai` |

## Навыки

Навыки — это углублённые руководства по специфическим темам. Каждый навык содержит пошаговые инструкции, скрипты и паттерны для конкретной области.

### Формы

| Навык | Описание |
|-------|----------|
| **1c-form-scaffold** | Создание и удаление управляемых форм (метаданные XML + Form.xml + Module.bsl) для любого объекта метаданных |
| **1c-form-compile** | Генерация Form.xml из компактного JSON DSL с корректными пространствами имён, идентификаторами и companion-элементами |
| **1c-form-edit** | Добавление элементов, реквизитов и команд в существующий Form.xml с автоматическим выделением ID |
| **1c-form-info** | Чтение Form.xml и вывод компактной сводки: дерево элементов, типизированные реквизиты, команды, события |
| **1c-form-validate** | Валидация Form.xml на структурные ошибки: уникальность ID, companion-элементы, ссылки DataPath и команд |
| **1c-form-patterns** | Справочник паттернов проектирования управляемых форм: архетипы, соглашения именования, продвинутые паттерны |

### Макеты (MXL)

| Навык | Описание |
|-------|----------|
| **1c-mxl-compile** | Компиляция Template.xml из компактного JSON DSL для табличных документов 1С |
| **1c-mxl-decompile** | Декомпиляция Template.xml в компактный JSON DSL (обратная операция к 1c-mxl-compile) |
| **1c-mxl-info** | Анализ Template.xml: именованные области, параметры, наборы колонок |
| **1c-mxl-validate** | Валидация Template.xml на структурные ошибки, которые платформа может игнорировать |

### Внешние обработки и интеграция с БСП

| Навык | Описание |
|-------|----------|
| **1c-epf-scaffold** | Генерация минимальных XML-исходников для внешней обработки: корневой файл метаданных и структура каталогов |
| **1c-bsp-registration** | Добавление `СведенияОВнешнейОбработке()` в модуль объекта для регистрации в подсистеме «Дополнительные отчёты и обработки» БСП |
| **1c-bsp-command** | Добавление команды в `СведенияОВнешнейОбработке()` и генерация обработчика |
| **1c-ssl-patterns** | Паттерны работы с БСП: пользователи и права, файлы, печатные формы, фоновые задания, версионирование, email |

### Роли и права

| Навык | Описание |
|-------|----------|
| **1c-role-compile** | Создание файлов ролей (метаданные + Rights.xml) по описанию набора прав |
| **1c-role-info** | Анализ Rights.xml: объекты, права, RLS, шаблоны ограничений |

### Запросы

| Навык | Описание |
|-------|----------|
| **1c-query-optimization** | Продвинутые паттерны оптимизации запросов: временные таблицы, JOIN vs подзапросы, параметры виртуальных таблиц, СКД, ВЫРАЗИТЬ, индексирование |

### Прочие объекты метаданных

| Навык | Описание |
|-------|----------|
| **1c-template-manage** | Добавление и удаление макетов (ТабличныйДокумент, HTML, Текст, ДвоичныеДанные) для объектов метаданных |
| **1c-help-manage** | Добавление встроенной справки к объекту метаданных: Help.xml, HTML-страница, обновление метаданных формы |

### Платформа и операции

| Навык | Описание |
|-------|----------|
| **1c-platform-ops** | Пакетные операции с платформой 1С:Предприятие: сборка/выгрузка EPF/ERF, загрузка/выгрузка конфигураций и расширений, запуск Предприятия и Конфигуратора |

### Утилиты

| Навык | Описание |
|-------|----------|
| **img-grid-analysis** | Наложение пронумерованной сетки на изображение печатной формы для определения границ колонок и пропорций при разработке MXL-макетов |
| **mermaid-diagrams** | Руководство по созданию читаемых Mermaid-диаграмм: шаблоны, совместимость, советы для агентов |
| **powershell-windows** | Правила корректного использования PowerShell на Windows: команды, пути, Docker, HTTP |

## Команды

### deploy_and_test.md

Команды для развёртывания и тестирования:

1. **Загрузка конфигурации** — загрузка из файлов в информационную базу
2. **Обновление БД** — обновление структуры базы данных
3. **Тестирование** — открытие веб-клиента для проверки

### getconfigfiles.md

Выгрузка объектов конфигурации из информационной базы в файлы для редактирования.

## Ключевые принципы

1. **Всегда используйте MCP-инструменты** — templatesearch перед написанием кода, search_metadata для проверки метаданных, docsearch для документации
2. **Избегайте антипаттернов** — запросы в циклах, точечная нотация, избыточные серверные вызовы
3. **Используйте БСП** — ОбщегоНазначения, СтроковыеФункцииКлиентСервер и другие модули
4. **Проводите самопроверку** — syntaxcheck после написания кода, внутреннее ревью
5. **Пишите код на русском языке** — переменные, комментарии, имена процедур

## Сообщество

- **Основные обсуждения**: [t.me/comol_it_does_matter](https://t.me/comol_it_does_matter)
- **Дополнительные материалы**: [t.me/yellow_ai_vibe](https://t.me/yellow_ai_vibe)
- **MCP-серверы**: [vibecoding1c.ru](https://vibecoding1c.ru/)

## Участие

Делитесь своими правилами, агентами и навыками — присылайте pull request!

---

*Репозиторий обновляется в процессе использования.*
# blathatabuh
